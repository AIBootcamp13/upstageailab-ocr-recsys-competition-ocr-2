title: "OCR Training Command Builder"

# UI schema for Streamlit command builder. Only for UI input validation and command building.
constant_overrides: []

ui_elements:
  - key: exp_name
    type: text_input
    label: "Experiment Name"
    default: "ocr_training"
    help: "A unique name for this experiment."
    hydra_override: "exp_name"
    validation:
      required: true
      min_length: 3

  - key: wandb
    type: checkbox
    label: "Use Weights & Biases"
    default: false
    hydra_override: "logger.wandb.enabled"

  - key: resume_training
    type: checkbox
    label: "Resume Training"
    default: false

  - key: checkpoint_path
    type: selectbox
    label: "Checkpoint Path"
    options_source: "checkpoints"
    default: ""
    visible_if: "resume_training == true"
    hydra_override: "trainer.ckpt_path"
    validation:
      required_if: "resume_training == true"

  - key: architecture
    type: selectbox
    label: "Architecture"
    options_source: "models.architectures"
    default: "dbnet"
    help: "OCR architecture preset (DBNet, CRAFT, DBNet++)."
    visible_if: "resume_training == false"
    hydra_override:
      - "model.architecture_name"
      - "model/architectures"
    metadata_help_key: "notes"
    architecture_fallback: "dbnet"

  - key: architecture_components
    type: info
    label: "Component Summary"
    visible_if: "resume_training == false"
    metadata_info_key: "components"
    info_template: "Encoder: {encoder}\nDecoder: {decoder}\nHead: {head}\nLoss: {loss}"

  - key: encoder
    type: selectbox
    label: "Backbone (Encoder)"
    options_source: "models.backbones"
    default: "resnet18"
    help: "Backbone encoder architecture."
    visible_if: "resume_training == false"
    hydra_override: "model.encoder.model_name"
    filter_by_architecture_key: "compatible_backbones"
    metadata_default_key: "default_backbone"
    metadata_help_key: "compatible_backbones"

  - key: optimizer
    type: selectbox
    label: "Optimizer"
    options_source: "models.optimizers"
    default: "adam"
    help: "Optimizer preset to load into the model configuration."
    visible_if: "resume_training == false"
    hydra_override: "model/optimizers"
    filter_by_architecture_key: "recommended_optimizers"
    metadata_default_key: "default_optimizer"
    metadata_help_key: "recommended_optimizers"

  - key: learning_rate
    type: slider
    label: "Learning Rate"
    min_value: 1.0e-5
    max_value: 1.0e-2
    default: 1.0e-3
    step: 1.0e-5
    format: "%.1e"
    hydra_override: "model.optimizer.lr"
    validation:
      required: true
    metadata_default_key: "default_learning_rate"
    optimizer_metadata_key: "learning_rate"
    optimizer_help_key: "learning_rate.help"

  - key: batch_size
    type: slider
    label: "Batch Size"
    min_value: 1
    max_value: 64
    default: 4
    step: 1
    hydra_override:
      - "dataloaders.train_dataloader.batch_size"
      - "dataloaders.val_dataloader.batch_size"
    validation:
      required: true
      min: 1

  - key: max_epochs
    type: slider
    label: "Max Epochs"
    min_value: 1
    max_value: 200
    default: 10
    step: 1
    hydra_override: "trainer.max_epochs"

  - key: seed
    type: number_input
    label: "Random Seed"
    default: 42
    min_value: 0
    hydra_override: "seed"

  - key: dataset
    type: selectbox
    label: "Dataset Config"
    options_source: "datasets"
    default: "default"
    help: "Hydra dataset configuration to load."
    visible_if: "resume_training == false"
    hydra_override: "data"
    metadata_default_key: "recommended_data"
