Orientation spot-check (EXIF 5-8) using remap_polygons + CLEvalMetric
Command: python - <<'PY'
import numpy as np
from ocr.metrics import CLEvalMetric
from ocr.utils.orientation import remap_polygons
raw_width, raw_height = 128, 256
raw_polygon = np.array(
    [
        [10.0, 20.0],
        [60.0, 20.0],
        [60.0, 80.0],
        [10.0, 80.0],
    ],
    dtype=np.float32,
)
metrics_by_orientation = {}
for orientation in (5, 6, 7, 8):
    canonical_polygon = remap_polygons([raw_polygon], raw_width, raw_height, orientation)[0]
    predicted_polygon = remap_polygons([raw_polygon], raw_width, raw_height, orientation)[0]
    det_quads = [predicted_polygon.reshape(-1).tolist()]
    gt_quads = [canonical_polygon.reshape(-1).tolist()]
    metric = CLEvalMetric()
    metric.update(det_quads, gt_quads)
    result = metric.compute()
    metrics_by_orientation[orientation] = {
        key: float(value.item()) if hasattr(value, "item") else float(value)
        for key, value in result.items()
        if key in {"precision", "recall", "f1"}
    }
print(metrics_by_orientation)
PY

Output:
{5: {'precision': 1.0, 'recall': 1.0, 'f1': 1.0}, 6: {'precision': 1.0, 'recall': 1.0, 'f1': 1.0}, 7: {'precision': 1.0, 'recall': 1.0, 'f1': 1.0}, 8: {'precision': 1.0, 'recall': 1.0, 'f1': 1.0}}
